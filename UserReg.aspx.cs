using System;
using System.Collections.Generic;
using System.Linq;
using System.Web;
using System.Web.UI;
using System.Web.UI.WebControls;
using System.Data.SqlClient;
using System.Configuration;

public partial class _Default : System.Web.UI.Page
{
    SqlConnection con;
    SqlCommand cmd;
    string str = ConfigurationManager.ConnectionStrings["myconnectionstring"].ConnectionString;
    protected void Page_Load(object sender, EventArgs e)
    {

    }
    protected void btn1_Click(object sender, EventArgs e)
    {
        string fname = textbox1.Text;
        string uname = textbox2.Text;
        string lname = textbox3.Text;
        string email = textbox4.Text;
        string location = textbox5.Text;
        string password = textbox6.Text;
        string dob = textbox7.Text;
        string mobile = textbox8.Text;
        //string lstate = "Pending";
        //con = new SqlConnection();
        //con.ConnectionString = str;

        //cmd = new SqlCommand();
        //cmd.CommandText = "Insert into Login(fname,lname,uname,email,Location,Password,Dateofbirth,mobile) values(@FN, @LN, @UN, @EM, @LT, @PW, @DB, @MO)";
        //cmd.Parameters.AddWithValue("@FN", fname);
        //cmd.Parameters.AddWithValue("@LN", lname);
        //cmd.Parameters.AddWithValue("@UN", uname);
        //cmd.Parameters.AddWithValue("@EM", email);
        //cmd.Parameters.AddWithValue("@LT", location);
        //cmd.Parameters.AddWithValue("@PW", password);
        //cmd.Parameters.AddWithValue("@DB", dob);
        //cmd.Parameters.AddWithValue("@MO", mobile);

        //cmd.Connection = con;
        //con.Open();

        //int rowcount = cmd.ExecuteNonQuery();
        //if (rowcount > 0)
        //{
        //    Response.Write("<script>alert('Record Added');</script>");
        //}
        //else
        //{
        //    Response.Write("<script>alert('Error Something Went Wrong');</script>");
        //}

        ////close connection
        //con.Close();
        SqlConnection con = new SqlConnection(str);
        SqlCommand cmd = new SqlCommand("Insert into UserReg(fname,lname,uname,email,Location,Password,Dateofbirth,mobile,state) values(@FN, @LN, @UN, @EM, @LT, @PW, @DB, @MO,'pending')", con);
        cmd.Parameters.AddWithValue("@FN", fname);
        cmd.Parameters.AddWithValue("@LN", lname);
        cmd.Parameters.AddWithValue("@UN", uname);
        cmd.Parameters.AddWithValue("@EM", email);
        cmd.Parameters.AddWithValue("@LT", location);
        cmd.Parameters.AddWithValue("@PW", password);
        cmd.Parameters.AddWithValue("@DB", dob);
        cmd.Parameters.AddWithValue("@MO", mobile);
        cmd.Connection = con;
        con.Open();
        
        cmd.ExecuteNonQuery();
    
        Response.Write("<script>alert('Record Added');</script>");
        textbox1.Text = "";
        textbox2.Text="";
        textbox3.Text="";
        textbox4.Text="";
        textbox5.Text="";
        textbox6.Text="";
        textbox7.Text="";
        textbox8.Text="";


    }

}